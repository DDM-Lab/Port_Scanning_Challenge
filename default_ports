#!/usr/bin/env python3
import random


def simulate_port_scan(ports):
    """
    Simulate a port scan by returning all ports as open.
    """
    return sorted(ports)


def format_nmap_output(open_ports, scanned_ports):
    """
    Formats and displays output similar to an Nmap scan.
    Every port in the scanned list is shown with its state
    (which will be "open" for all ports in this version) and its corresponding service.
    """
    print("\nNmap scan report:")
    print(f"Ports scanned: {len(scanned_ports)}")
    print("Starting Nmap 7.80 ( https://nmap.org ) at 2024-11-29 02:00 EST\n")
    print("PORT     STATE   SERVICE")
    services = {
        22: "ssh",
        80: "http",
        443: "https",
        8080: "http-alt",
        31337: "elite",
        65432: "unknown"
    }
    for port in scanned_ports:
        state = "open" if port in open_ports else "closed"
        service = services.get(port, "unknown")
        print(f"{port:<8} {state:<7} {service}")
    print("\nNmap done: 1 IP address (1 host up) scanned")


def connect_to_port(port, encoded_parts, connected_ports):
    """
    Connects to a specified port and reveals an encoded part if available.
    If the port hasn't been connected before and an encoded part exists,
    the part is popped from the list and displayed.
    """
    if port not in connected_ports and encoded_parts:
        connected_ports.append(port)
        encoded_part = encoded_parts.pop(0)
        part_number = len(connected_ports)
        print(f"\nConnected to port {port}")
        print(f"Encoded part {part_number} of 4 found: {encoded_part}")
        
        if part_number == 1:
            print("\nMilestone: You found the first encoded part!")
        elif part_number == 4:
            print("\nMilestone: You found all encoded parts!")
            return True
    elif port in connected_ports:
        print(f"\nAlready connected to port {port}. No new encoded parts.")
    else:
        print(f"\nConnected to port {port}, but no new encoded parts found.")
    
    return False


def analyze_text(encoded_text):
    """
    Simulates analyzing the complete encoded text.
    """
    print("\nNow it's time to analyze the encoded text and find the flag!")
    print(f"Encoded text: {encoded_text}")


def main():
    """
    Main function to run the Port Scanner Challenge game.
    """
    # Pre-defined encoded text (for demonstration purposes)
    encoded_text = "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vxxUdibNnj07bPuci3UK3O517QPhRPpMtYnU1v5lBU6LFy8OquMW6XcpcJuuW7cuqAxNG1eycda9+uqr+vDDD+X1evXCCy/o5z//ubuKo3Xr1vrTn/6kTp06qaamRvPnz29Q/8wzzX/F+cILL3QX1UubNm304osvqmfPnjLGaM6cOUFXEI8fP64ePXpowIABGjhwYNC8ktShQwf169dPkvTll1826OpKtI4fP64JEyaooqJCd9xxh7sYPrbaLC0tTR6PRzk5OZo5c2bYq8OR/POf/9TcuXMlSQ8++KCmTp2qmJgYdzVJksfj0aRJkzRixAjJd6cnJydH8l3NXLp0qYwxuuWWWzRgwADX3NItt9yi/v37q6SkRG+88Ya7OCoej0d33nmnZs2aJUlav3691q5d666mf/3rX5owYYL69eunvXv3qmPHjs5doWi0b99eiYmJqqmp0aRJk1RYWOiuUqeqqio99dRTKioqUkJCgl599VVdcskl7mpBrrnmGmVlZUmSPvjgg5BuB8eOHVNBQYHi4uL0k5/8JKjsXGmM63SuxMfHq2vXrpKkJ554wvl+1Nf555+vdu3aSb7vFn44CNlNiP+BppSUFB0+fFh/+9vfdNlllzkPYER62KiuBx+rqqq0fPnyoOW1bNlS999/f0hfab9Tp07pnXfe0XXXXadmzZo5D3DcdNNN2rBhQ60h4Ntvv9WSJUsk3238X/7yl+4qIXr06KERI0aoV69eGjRokLv4ByclJUUPP/yw5HugcMuWLU7ZPffco927d+uTTz5RYmJiwFyhmjdvLo/H4/6zFcYYPfvss9qyZYtGjx6tu+++210FPrba7J577nEewFq8eLE++eQTd5U6vf76604IfPjhh8MGbL+YmBiNGTNGXbt21W233ab4+HjJd+Lg794wdOhQNW/e3DXn/58g+08ePvnkE5WVlbmrRMX/4FlaWpokadmyZfruu++C6ixevFj//d//LUkaP368tm7dqp/+9KdBdSK55JJLNGfOHOckJisrq9bjVyRbt27VqlWrJEkTJ050Pntdhg4dqj59+uj22293tq9fXl6eTpw4oU6dOik5OTmo7FxpjOt0riQlJWnBggWKj49XUVGRnnrqqZAufvhxI2Q3QadOndK8efM0ZMiQoDPnhj5sdOjQIV1zzTW6++67g5ZXVlamJUuW6JJLLgl5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"
    
    # Split the encoded text into roughly equal parts
    part_length = len(encoded_text) // 4
    encoded_parts = [
        encoded_text[i:i + part_length] for i in range(0, len(encoded_text), part_length)
    ]
    
    connected_ports = []
    
    # List of ports available for scanning
    ports_to_scan = [22, 80, 443, 8080, 31337, 65432]
    
    open_ports = []  # This will be updated via simulate_port_scan
    attempted_ports = set()

    print("Welcome to the Port Scanner Challenge!")
    print("Scan ports to find open ones, then connect to reveal encoded parts.")
    print("Commands: 'scan', 'connect <port>', or 'exit'")
    
    while True:
        user_input = input("\nEnter command: ").lower().split()
        
        if not user_input:
            continue

        command = user_input[0]
        
        if command == "exit":
            break
        elif command == "scan":
            open_ports = simulate_port_scan(ports_to_scan)
            format_nmap_output(open_ports, ports_to_scan)
        elif command == "connect" and len(user_input) == 2:
            try:
                port = int(user_input[1])
                attempted_ports.add(port)
                if port in open_ports:
                    all_parts_found = connect_to_port(port, encoded_parts, connected_ports)
                    if all_parts_found:  # All parts have been revealed
                        analyze_text(encoded_text)
                        break
                else:
                    print(f"\nPort {port} is not open or hasn't been scanned yet.")
            except ValueError:
                print("Invalid port number. Please enter a valid number.")
        else:
            print("Invalid command. Use 'scan', 'connect <port>', or 'exit'.")

    # Summary of results after exiting or completing the challenge
    print("\nChallenge complete. Thanks for participating!")
    print(f"\nPorts connected: {connected_ports}")
    print("Please copy the order of the ports.")
    print(f"Total unique ports connected: {len(connected_ports)}")
    print(f"Total ports attempted: {len(attempted_ports)}")
    
    invalid_attempts = len(attempted_ports - set(ports_to_scan))
    
    print(f"Invalid ports attempted: {invalid_attempts}")


if __name__ == "__main__":
    main()
