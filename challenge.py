import random

def simulate_port_scan(ports):
    open_ports = random.sample(ports, k=random.randint(3, len(ports)))
    return sorted(open_ports)

def format_nmap_output(open_ports, total_ports):
    print("\nNmap scan report:")
    print(f"Ports scanned: {total_ports}")
    print("Starting Nmap 7.80 ( https://nmap.org ) at 2024-11-29 02:00 EST\n")
    print("PORT     STATE  SERVICE")
    services = {22: 'ssh', 80: 'http', 443: 'https', 8080: 'http-alt', 31337: 'elite', 65432: 'unknown'}
    for port in open_ports:
        service = services.get(port, 'unknown')
        print(f"{port:<8} open   {service}")
    print("\nNmap done: 1 IP address (1 host up) scanned")

def connect_to_port(port, encoded_parts, connected_ports):
    if port not in connected_ports and encoded_parts:
        connected_ports.append(port)
        encoded_part = encoded_parts.pop(0)
        print(f"\nConnected to port {port}")
        print(f"Encoded part found: {encoded_part}")
    elif port in connected_ports:
        print(f"\nAlready connected to port {port}. No new encoded parts.")
    else:
        print(f"\nConnected to port {port}, but no new encoded parts found.")

def main():
    encoded_text = "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"
    encoded_parts = [encoded_text[i:i+len(encoded_text)//4] for i in range(0, len(encoded_text), len(encoded_text)//4)]
    connected_ports = []
    ports_to_scan = [22, 80, 443, 8080, 31337, 65432]
    open_ports = []
    
    print("Welcome to the Port Scanner Challenge!")
    print("Scan ports to find open ones, then connect to reveal encoded parts.")
    print("Commands: 'scan', 'connect <port>', or 'exit'")

    while True:
        user_input = input("\nEnter command: ").lower().split()
        
        if user_input[0] == 'exit':
            break
        elif user_input[0] == 'scan':
            open_ports = simulate_port_scan(ports_to_scan)
            format_nmap_output(open_ports, len(ports_to_scan))
        elif user_input[0] == 'connect' and len(user_input) == 2:
            try:
                port = int(user_input[1])
                if port in open_ports:
                    connect_to_port(port, encoded_parts, connected_ports)
                    if not encoded_parts:
                        print("\nYou've found all encoded parts. Time to analyze!")
                        analyze_text(encoded_text)
                        break
                else:
                    print(f"\nPort {port} is not open or hasn't been scanned yet.")
            except ValueError:
                print("Invalid port number. Please enter a valid number.")
        else:
            print("Invalid command. Use 'scan', 'connect <port>', or 'exit'.")

    print("\nChallenge complete. Thanks for participating!")
    print(f"\nPorts connected: {connected_ports}")
    print("Please copy the order of the ports")
    print(f"Total unique ports connected: {len(connected_ports)}")

def analyze_text(encoded_text):
    print("\nNow it's time to analyze the encoded text and find the flag!")
    print(f"Encoded text: {encoded_text}")


if __name__ == "__main__":
    main()